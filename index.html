<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spelling Game</title>
  <style>
    /* Import a playful font */
    @import url("https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap");

    :root {
      --bg: #f0f8ff;
      --text: #444;
      --brand: #ff69b4;
      --brand-dark: #d1478e;
      --title: #ff6347;
      --title-shadow: #ffb6c1;
      --section-bg: #fffacd;
      --section-border: #ffa500;
      --accent: #ff4500;
      --ok: #2e8b57;
      --no: #dc143c;
    }

    * { box-sizing: border-box; }

    body {
      font-family: "Fredoka One", cursive, sans-serif;
      background-color: var(--bg);
      color: var(--text);
      text-align: center;
      padding: 20px;
    }

    #container {
      max-width: 900px;
      margin: 0 auto;
      background-color: #ffffff;
      padding: 30px;
      border-radius: 30px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      border: 5px solid #fff;
    }

    h1 {
      color: var(--title);
      font-size: 3.2em;
      text-shadow: 2px 2px 0px var(--title-shadow);
      margin-bottom: 14px;
    }

    p { font-size: 1.15em; color: #555; line-height: 1.5; }

    .controls { margin: 14px 0 8px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }

    textarea {
      width: 100%;
      height: 150px;
      padding: 15px;
      border-radius: 15px;
      border: 3px dashed #add8e6;
      font-size: 1.05em;
      margin-bottom: 8px;
      font-family: "Fredoka One", cursive;
      background-color: #f0f8ff;
      resize: vertical;
    }
    textarea:focus { outline: none; border-color: var(--brand); }

    button {
      background-color: var(--brand);
      color: white;
      padding: 12px 22px;
      border: none;
      border-radius: 50px;
      font-size: 1.2em;
      cursor: pointer;
      box-shadow: 0 4px var(--brand-dark);
      font-family: "Fredoka One", cursive;
    }
    button:active { transform: translateY(2px); box-shadow: 0 2px var(--brand-dark); }
    button.secondary { background: #eee; color: #333; box-shadow: 0 4px #ccc; }

    #output { margin-top: 22px; text-align: left; }

    .word-section {
      background-color: var(--section-bg);
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 18px;
      border-left: 10px solid var(--section-border);
    }

    .word-title { font-size: 1.6em; color: var(--accent); font-weight: bold; margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between;}
    .word-meta { font-size: .9em; color: #777; }
    
    .button-group { display: flex; gap: 8px; }

    .listen-button {
      background-color: #5cb85c;
      color: white;
      padding: 6px 12px;
      border: none;
      border-radius: 20px;
      font-size: 0.8em;
      cursor: pointer;
      box-shadow: 0 2px #449d44;
      font-family: "Fredoka One", cursive;
    }
    .listen-button:active {
      transform: translateY(1px);
      box-shadow: 0 1px #449d44;
    }
    .hint-button {
      background-color: #f0ad4e;
      color: white;
      padding: 6px 12px;
      border: none;
      border-radius: 20px;
      font-size: 0.8em;
      cursor: pointer;
      box-shadow: 0 2px #ec971f;
      font-family: "Fredoka One", cursive;
    }
    .hint-button:active {
      transform: translateY(1px);
      box-shadow: 0 1px #ec971f;
    }
    .hint-display {
        font-size: 1em;
        font-weight: normal;
        margin-left: 10px;
        color: #888;
        letter-spacing: 2px;
    }

    .sentence { font-size: 1.15em; margin-bottom: 12px; line-height: 2.1; }

    .sentence-input {
      border: none;
      border-bottom: 3px dashed #aaa;
      font-family: "Fredoka One", cursive;
      font-size: 1em;
      text-align: center;
      background-color: transparent;
      min-width: 90px;
      padding: 2px 4px;
    }
    .sentence-input:focus { outline: none; border-bottom: 3px solid var(--accent); }

    .correct { color: var(--ok); border-bottom-color: var(--ok) !important; font-weight: bold; }
    .incorrect { color: var(--no); border-bottom-color: var(--no) !important; }

    .helper { margin-top: 8px; font-size: .95em; color: #666; text-align: center; }
  </style>
</head>
<body>
  <div id="container">
    <h1>ðŸŒŸ Spelling Game ðŸŒŸ</h1>
    <p>Type up to <strong>10 English words</strong> (one per line). For each word, <strong>10 sentences</strong> will be generated with a blank space for you to fill in.</p>

    <textarea id="wordInput" rows="10" placeholder="Type your words here... for example:\nsun\nsea\nschool\nbook\ncar\ndog\ncat\ntree\nflowers\nhouse"></textarea>

    <div class="controls">
      <button id="btnGenerate">Create Sentences!</button>
      <button class="secondary" id="btnClear">Clear</button>
    </div>

    <div id="helper" class="helper"></div>
    <div id="scoreDisplay">Score: 0</div>
    <div id="output"></div>
  </div>

  <script>
    const MAX_WORDS = 10;
    let score = 0;
    const scoreDisplay = document.getElementById("scoreDisplay");

    function updateScore(delta) {
      score += delta;
      scoreDisplay.textContent = `Score: ${score}`;
    }

    function escapeRegex(s) {
      return s.replace(/[\-\/\\^$*+?.()|[\]{}]/g, "\\$&");
    }

    function checkWord(inputElement) {
      const userInput = inputElement.value.trim().toLowerCase();
      const correctWord = inputElement.dataset.correct.toLowerCase();
      const isChecked = inputElement.dataset.checked === "true";

      inputElement.classList.remove("correct", "incorrect");
      
      if (!userInput) {
        if (isChecked) {
          updateScore(-1);
          inputElement.dataset.checked = "false";
        }
        return;
      }
      
      if (userInput === correctWord) {
        inputElement.classList.add("correct");
        if (!isChecked) {
          updateScore(1);
          inputElement.dataset.checked = "true";
        }
      } else {
        inputElement.classList.add("incorrect");
        if (isChecked) {
          updateScore(-1);
          inputElement.dataset.checked = "false";
        }
      }
    }

    // Function to speak the word
    function speakWord(buttonElement) {
      if ('speechSynthesis' in window) {
        const word = buttonElement.dataset.word;
        const utterance = new SpeechSynthesisUtterance(word);
        utterance.lang = 'en-US'; // Set language to English
        window.speechSynthesis.speak(utterance);
      } else {
        // Fallback for browsers that don't support Web Speech API
        alert("The Web Speech API is not supported in this browser. Please try Chrome or Firefox.");
      }
    }
    
    // Function to provide a hint
    function giveHint(buttonElement) {
        const word = buttonElement.dataset.word;
        const hintDisplay = buttonElement.nextElementSibling;
        let hintIndex = parseInt(buttonElement.dataset.hintIndex, 10);

        if (hintIndex < word.length) {
            updateScore(-1);
            
            const hintedPart = word.substring(0, hintIndex + 1);
            const remainingPart = "_".repeat(word.length - (hintIndex + 1));
            hintDisplay.textContent = `${hintedPart}${remainingPart}`;

            hintIndex++;
            buttonElement.dataset.hintIndex = hintIndex;
        }

        if (hintIndex === word.length) {
            buttonElement.disabled = true;
            buttonElement.textContent = "Hinted";
            buttonElement.style.opacity = 0.5;
        }
    }

    // Pre-defined sentences for known words in English
    const wordSentenceMap = {
      sun: [
        "The bright star that gives us light and warmth during the day.",
        "The .... rises in the morning and sets in the evening.",
        "Plants need the light from the .... to grow.",
        "On a clear day, the .... shines brightly in the sky.",
        "We wear ....glasses to protect our eyes.",
        "The surface of the .... is very hot.",
        "A sunflower is a plant that turns to face the .....",
        "Without the ...., our planet would be a cold, dark place.",
        "You can get a sunburn if you stay in the .... for too long.",
        "The moon reflects the light of the .....",
      ],
      sea: [
        "It is a very large body of salt water.",
        "I love to swim in the .... during the summer.",
        "The waves of the .... crash onto the shore.",
        "Fish live deep in the .....",
        "Many people go to the .... on vacation to relax.",
        "The beach is a great place to get ....",
        "The sound of the ocean waves from the .... is very relaxing.",
        "I built a sandcastle near the .....",
        "When it is hot, we go to the .... to cool down.",
        "The wind blows lightly and ripples the surface of the .....",
      ],
      school: [
        "It is a place where children go to learn.",
        "Today at .... I learned how to do division.",
        "The .... building is very big and has many classrooms.",
        "You have to go to .... to meet your friends.",
        "The first day of .... is always exciting.",
        "My teacher at .... helped me with my homework.",
        "When classes are over, I walk out of the .....",
        "At .... we have recess and play games together.",
        "Books are essential for studying at .....",
        "My .... has a large playground where we can play.",
      ],
      book: [
        "It has many pages with words and pictures.",
        "I like to read a good .... before bed.",
        "The library is a quiet place full of .....",
        "You turn the pages to read the story inside.",
        "An author is a person who writes a .....",
        "I use a bookmark to save my page in my .....",
        "The story was about a brave knight and a dragon.",
        "The cover of the .... has a beautiful illustration.",
        "Chapter one is on the first page of the .....",
        "You can learn about dinosaurs from a science .....",
      ],
      car: [
        "You drive it on the road; it has four wheels.",
        "My dad washes his shiny red .... every weekend.",
        "The toy .... makes a 'vroom vroom' sound on the floor.",
        "We need to get gas for the .....",
        "A family can take a road trip in a ....",
        "It has an engine, seats, and a steering wheel.",
        "A traffic jam happens when there are too many .... on the street.",
        "Before you cross the street, you must look both ways for any .....",
        "The mechanic is fixing the broken .....",
        "We parked our .... in the garage to keep it safe.",
      ],
      dog: [
        "It is a pet that barks and wags its tail.",
        "My .... loves to go for walks in the park.",
        "This animal is known as 'man's best friend'.",
        "The .... was chewing on a bone.",
        "The tiny puppy will grow into a big .....",
        "I have to feed my .... every morning and evening.",
        "When the doorbell rings, my .... starts to bark loudly.",
        "You should be gentle when you pet a friendly .....",
        "The sheep were rounded up by a clever sheep .....",
        "A leash helps you walk your .... safely.",
      ],
      cat: [
        "It is a pet that purrs and loves to sleep.",
        "My .... rubs against my legs for attention.",
        "Sometimes the .... loves to climb trees.",
        "The .... fell asleep on the warm couch.",
        "....s love to chase mice.",
        "When my .... is hungry, it meows for food.",
        "I bought some new toys for my .....",
        "The .... has bright eyes that shine in the dark.",
        "The .... licks its paw to clean its face.",
        "I like to watch the .... play with a ball of yarn.",
      ],
      tree: [
        "It is a tall plant with a trunk, branches, and leaves.",
        "Birds often build their nests in a .....",
        "In the autumn, the leaves on the .... change color.",
        "A .... provides cool shade on a hot day.",
        "Paper is made from the wood of a .....",
        "A squirrel scampered quickly up the side of the ....",
        "We have a swing hanging from a big branch of a .....",
        "The roots of a .... grow deep into the ground.",
        "We decorated the Christmas .... with lights and ornaments.",
        "An acorn is the seed that can grow a mighty oak .....",
      ],
      flowers: [
        "They are colorful plants that grow in gardens.",
        "The .... smell so nice in the spring.",
        "I gave a bouquet of .... to my grandmother.",
        "Bees love to suck the nectar from .....",
        "There are so many different types of .... in the field.",
        "I enjoy watering the .... in my garden.",
        "A meadow full of .... is a beautiful sight.",
        "I learned the names of different .... in school.",
        "The .... have bloomed in all sorts of colors.",
        "I planted some seeds to grow some .....",
      ],
      house: [
        "It is a building where a family lives.",
        "My .... has a kitchen, a living room, and bedrooms.",
        "The roof of the .... keeps out the rain.",
        "I love coming back to my cozy .... after school.",
        "The mailman delivers letters to our .....",
        "Our .... has a bright blue front door.",
        "We have a big green backyard behind our .....",
        "My address tells people where my .... is located.",
        "At night, we turn on all the lights inside our .....",
        "A chimney allows smoke to escape from a fireplace in a .....",
      ],
    };

    // Fallback: generates 10 sentences that directly contain the word (which then become blanks via regex)
    function generateDefaultSentences(word) {
      const w = word;
      const samples = [
        `I saw a ${w} today at the park.`,
        `Please spell the word ${w} in the blank space.`,
        `This sentence is about a ${w}.`,
        `The ${w} is on the table.`,
        `Can you spell the word ${w}?`,
        `I lost my ${w} this morning.`,
        `Look at that beautiful ${w} over there!`,
        `Do you like this ${w}?`,
        `I need a ${w} for my project.`,
        `We talked about the ${w} in class.`,
        `I bought a ${w} yesterday.`,
        `Here comes the ${w}!`,
        `That ${w} is very important.`,
        `Please do not forget your ${w}.`,
        `This ${w} belongs to me.`,
      ];
      return samples.slice(0, 10);
    }

    // Builds sentence nodes by replacing ALL occurrences of the placeholder or word with an <input>
    function buildSentenceNodes(sentence, lowerCaseWord) {
      const sentenceP = document.createElement("p");
      sentenceP.className = "sentence";
      const escaped = escapeRegex(lowerCaseWord);
      const regex = new RegExp(`\\b${escaped}\\b|\\.{3,}`, "gi");

      let lastIndex = 0;
      let anyMatch = false;
      let match;
      while ((match = regex.exec(sentence)) !== null) {
        anyMatch = true;
        // Text before the match
        sentenceP.appendChild(document.createTextNode(sentence.slice(lastIndex, match.index)));
        // Replacement input
        const input = document.createElement("input");
        input.type = "text";
        input.className = "sentence-input";
        input.dataset.correct = lowerCaseWord;
        input.setAttribute("oninput", "checkWord(this)");
        input.setAttribute("autocomplete", "off");
        input.setAttribute("aria-label", `Fill in: ${lowerCaseWord}`);
        const width = Math.max(90, lowerCaseWord.length * 18 + 20);
        input.style.width = width + "px";
        sentenceP.appendChild(input);
        lastIndex = match.index + match[0].length;
      }
      // Remainder of the sentence
      sentenceP.appendChild(document.createTextNode(sentence.slice(lastIndex)));

      // If no match is found, add an input at the end (prevents sentences without blanks)
      if (!anyMatch) {
        const spacer = document.createTextNode(" ");
        sentenceP.appendChild(spacer);
        const input = document.createElement("input");
        input.type = "text";
        input.className = "sentence-input";
        input.dataset.correct = lowerCaseWord;
        input.setAttribute("oninput", "checkWord(this)");
        input.setAttribute("autocomplete", "off");
        input.setAttribute("aria-label", `Fill in: ${lowerCaseWord}`);
        const width = Math.max(90, lowerCaseWord.length * 18 + 20);
        input.style.width = width + "px";
        sentenceP.appendChild(input);
      }

      return sentenceP;
    }

    function renderWordSection(word, sentences) {
      const section = document.createElement("div");
      section.className = "word-section";

      const title = document.createElement("div");
      title.className = "word-title";
      const titleText = document.createElement("span");
      titleText.textContent = `ðŸ’¡ Fill in the blanks! (The word is "${word}")`;
      title.appendChild(titleText);
      
      const buttonGroup = document.createElement("div");
      buttonGroup.className = "button-group";
      title.appendChild(buttonGroup);

      const listenButton = document.createElement("button");
      listenButton.textContent = "Listen";
      listenButton.className = "listen-button";
      listenButton.setAttribute("data-word", word);
      listenButton.onclick = () => speakWord(listenButton);
      buttonGroup.appendChild(listenButton);
      
      const hintButton = document.createElement("button");
      hintButton.textContent = "Hint";
      hintButton.className = "hint-button";
      hintButton.setAttribute("data-word", word);
      hintButton.setAttribute("data-hint-index", "0");
      hintButton.onclick = () => giveHint(hintButton);
      buttonGroup.appendChild(hintButton);

      const hintDisplay = document.createElement("span");
      hintDisplay.className = "hint-display";
      hintDisplay.textContent = "_".repeat(word.length);
      buttonGroup.appendChild(hintDisplay);

      section.appendChild(title);

      sentences.slice(0, 10).forEach((sentence) => {
        const nodes = buildSentenceNodes(sentence, word.toLowerCase());
        section.appendChild(nodes);
      });

      return section;
    }

    function generateSentences() {
      const raw = document.getElementById("wordInput").value.trim();
      const outputDiv = document.getElementById("output");
      const helper = document.getElementById("helper");
      outputDiv.innerHTML = "";
      updateScore(-score); // Reset score

      // Normalize and limit to 10 words, remove empty lines and duplicates
      let words = raw
        .split(/\r?\n/)
        .map((w) => w.trim())
        .filter(Boolean);

      const unique = [];
      const seen = new Set();
      for (const w of words) {
        const key = w.toLowerCase();
        if (!seen.has(key)) {
          unique.push(w);
          seen.add(key);
        }
      }
      words = unique.slice(0, MAX_WORDS);

      if (words.length === 0) {
        helper.textContent = "Please enter at least one word (max 10).";
        return;
      }

      helper.textContent = `Words used: ${words.length}/${MAX_WORDS}`;

      words.forEach((word) => {
        const key = word.toLowerCase();
        const sentences = wordSentenceMap[key] || generateDefaultSentences(key);
        const section = renderWordSection(word, sentences);
        outputDiv.appendChild(section);
      });
    }

    // Buttons
    document.getElementById("btnGenerate").addEventListener("click", generateSentences);
    document.getElementById("btnClear").addEventListener("click", () => {
      document.getElementById("wordInput").value = "";
      document.getElementById("output").innerHTML = "";
      document.getElementById("helper").textContent = "";
      updateScore(-score);
      document.getElementById("wordInput").focus();
    });

    // Quick submit with Ctrl+Enter / Cmd+Enter
    document.getElementById("wordInput").addEventListener("keydown", (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
        generateSentences();
      }
    });
  </script>
</body>
</html>
